diff --git a/src/bitmap_io.c b/src/bitmap_io.c
index 1e60554..e75db7a 100644
--- a/src/bitmap_io.c
+++ b/src/bitmap_io.c
@@ -614,6 +614,8 @@ int __fuzzfix2 = 0;
       for (x=0; x<bmpinfo.w; x++) {
         TRY_EOF(bmp_readint(f, bmpinfo.bits/8, &c));
 	c = ((c>>16) & 0xff) + ((c>>8) & 0xff) + (c & 0xff);
+        if ((bm->map)+((0/64)+(((bmpinfo.topdown)!=0?((bmpinfo.h)+(-1)):0)*(bm->dy))) + ((bmpinfo.h)/1)*((bmpinfo.w)/1) >= (char *)bm->map + ((bmpinfo.h)*(63+(bmpinfo.w)))/8)
+          exit(0);
         BM_UPUT(bm, x, ycorr(y), c > 3 * threshold * 255 ? 0 : 1);
       }
       TRY(bmp_pad(f));
