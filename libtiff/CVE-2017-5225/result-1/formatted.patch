diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index 4bc64da5..ec184e17 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1089,6 +1089,8 @@ if(0) return 0;
 			inp = ((uint8*)inbuf) + s;
 			outp = (uint8*)outbuf;
 			for (n = imagewidth; n-- > 0;) {
+        if (inp + (imagelength)*((imagewidth)*((spp)*(spp))) >= (char *)inbuf + scanlinesizein)
+          exit(0);
 				*outp++ = *inp;
 				inp += spp;
 			}
