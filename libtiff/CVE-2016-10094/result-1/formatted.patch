diff --git a/tools/tiff2pdf.c b/tools/tiff2pdf.c
index 47d76298..730ee4ab 100644
--- a/tools/tiff2pdf.c
+++ b/tools/tiff2pdf.c
@@ -2898,7 +2898,9 @@ tsize_t t2p_readwrite_pdf_image_tile(T2P* t2p, TIFF* input, TIFF* output, ttile_
 				if (count >= 4) {
                                         int retTIFFReadRawTile;
                     /* Ignore EOI marker of JpegTables */
-					_TIFFmemcpy(buffer, jpt, count - 2);
+					if (buffer + (-2)+(count) >= (char *)buffer + t2p->tiff_datasize)
+            exit(0);
+          _TIFFmemcpy(buffer, jpt, count - 2);
 					bufferoffset += count - 2;
                     /* Store last 2 bytes of the JpegTables */
 					table_end[0] = buffer[bufferoffset-2];
